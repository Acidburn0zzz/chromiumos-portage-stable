From 47f431ae4b0f8e7851ba17f190b606ccbcf52acd Mon Sep 17 00:00:00 2001
From: Gwendal Grignou <gwendal@chromium.org>
Date: Fri, 17 Jan 2020 16:46:21 -0800
Subject: [PATCH] Pick sqlite upstream patch from
 https://github.com/sqlite/sqlite/commit/a6c1a71cde082e09750465d5675699062922e387.patch
 to fix CVE-2019-20218.

---
 sqlite3.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/sqlite3.c b/sqlite3.c
index 1a5886b..4df15f8 100644
--- a/sqlite3.c
+++ b/sqlite3.c
@@ -130566,7 +130566,7 @@ static int selectExpander(Walker *pWalker, Select *p){
 
   /* Process NATURAL keywords, and ON and USING clauses of joins.
   */
-  if( db->mallocFailed || sqliteProcessJoin(pParse, p) ){
+  if( pParse->nErr || db->mallocFailed || sqliteProcessJoin(pParse, p) ){
     return WRC_Abort;
   }
 
-- 
2.24.1

