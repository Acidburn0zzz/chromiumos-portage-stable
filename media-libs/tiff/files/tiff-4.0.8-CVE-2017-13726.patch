commit 4958e19faedbda5da699a61009e6c774884d6f8a
Author: Even Rouault <even.rouault@spatialys.com>
Date:   Wed Aug 23 13:21:41 2017 +0000

    * libtiff/tif_dirwrite.c: replace assertion related to not finding the
    SubIFD tag by runtime check.
    Fixes http://bugzilla.maptools.org/show_bug.cgi?id=2727
    Reported by team OWL337

CHROMIUM: Removed the ChangeLog changes since they were causing a conflict.

diff --git a/libtiff/tif_dirwrite.c b/libtiff/tif_dirwrite.c
index 449cec32..9553f860 100644
--- a/libtiff/tif_dirwrite.c
+++ b/libtiff/tif_dirwrite.c
@@ -821,7 +821,12 @@ TIFFWriteDirectorySec(TIFF* tif, int isimage, int imagedone, uint64* pdiroff)
 			TIFFDirEntry* nb;
 			for (na=0, nb=dir; ; na++, nb++)
 			{
-				assert(na<ndir);
+				if( na == ndir )
+                                {
+                                    TIFFErrorExt(tif->tif_clientdata,module,
+                                                 "Cannot find SubIFD tag");
+                                    goto bad;
+                                }
 				if (nb->tdir_tag==TIFFTAG_SUBIFD)
 					break;
 			}
